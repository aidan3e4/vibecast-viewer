services:
  camera-server:
    build:
      context: .
      dockerfile: Dockerfile
    image: camera-server:latest
    container_name: camera-server

    # Port mappings
    ports:
      - "2121:2121"  # FTP server
      - "8001:8001"  # Analyzer UI

    # Environment variables (override with .env file)
    environment:
      - CAMERA_IP=${CAMERA_IP}
      - CAMERA_USERNAME=${CAMERA_USERNAME}
      - CAMERA_PASSWORD=${CAMERA_PASSWORD}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - FTP_USER=${FTP_USER}
      - FTP_PASSWORD=${FTP_PASSWORD}
      - FTP_PORT=${FTP_PORT}
      # - CAPTURE_INTERVAL=${CAPTURE_INTERVAL:-60}
      # - PLACE=${PLACE:-office}

    # Mount data directory for persistent storage
    volumes:
      - ./data:/app/data
      # Optional: Mount .env file if you prefer file-based config
      # - ./.env:/app/.env:ro

    # # Override default command with actual capture script
    # command: >
    #   python -m app.capture
    #   --interval ${CAPTURE_INTERVAL:-10}
    #   --place ${PLACE:-test}
    #   -v B

    # Restart policy
    restart: unless-stopped

    # Resource limits (optional)
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '1.0'
    #       memory: 1G
    #     reservations:
    #       cpus: '0.5'
    #       memory: 512M
